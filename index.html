<!doctype html>
<meta charset="utf-8">
<title>GameCre8 — Prompt → Play</title>
<style>
  body{margin:0;background:#0b0c10;color:#eaeaf0;font:16px system-ui,-apple-system,Segoe UI,Roboto,Arial}
  .wrap{max-width:880px;margin:48px auto;padding:0 20px}
  .card{background:#13141a;border-radius:16px;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
  form{display:flex;gap:10px}
  input[type="text"]{flex:1;padding:16px 14px;border-radius:12px;border:1px solid #23242e;background:#0f1016;color:#eaeaf0}
  button{padding:16px 18px;border:0;border-radius:12px;background:#fff;color:#111;font-weight:700;cursor:pointer}
  .msg{margin-top:12px;color:#9aa0a6}
  a{color:#9ad0ff}
</style>
<div class="wrap">
  <h1>GameCre8</h1>
  <div class="card">
    <form id="f">
      <input id="p" placeholder="Describe your game… e.g., neon galaxy blaster with enemy waves" autofocus maxlength="120">
      <button>Create & Play</button>
    </form>
    <div class="msg" id="m">Type a prompt and press Enter.</div>
  </div>
</div>
<script>
const form = document.getElementById('f');
const input = document.getElementById('p');
const msg = document.getElementById('m');

form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const prompt = input.value.trim() || 'quick smoke test';
  msg.textContent = 'Creating…';

  try {
    const resp = await fetch('/api/prompt-create', {
      method: 'POST',
      headers: { 'content-type': 'application/json' },
      body: JSON.stringify({ prompt })
    });
    const json = await resp.json();
    if (!json.ok) {
      msg.textContent = 'Error: ' + (json.error || 'failed');
      return;
    }
    msg.innerHTML = 'Launching… If not redirected, open: ' +
      `<a href="${json.url}">${json.url}</a>` +
      `<br><small>Alternates: <a href="${json.candidates.play}">/play</a> · <a href="${json.candidates.play_html}">/play.html</a></small>`;
    location.href = json.url; // navigate to the working one
  } catch (err) {
    msg.textContent = 'Request failed: ' + err.message;
  }
});
</script>
