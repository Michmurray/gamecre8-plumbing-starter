<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GameCre8 ‚Äî Prompt ‚Üí Play</title>
  <style>
    :root { --bg:#0b0c10; --card:#13141a; --fg:#eaeaf0; --muted:#9aa0a6; --accent:#6ee7ff; }
    *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--fg);font:16px system-ui,-apple-system,Segoe UI,Roboto,Arial}
    .wrap{max-width:880px;margin:48px auto;padding:0 20px}
    .logo{font-weight:800;font-size:28px;letter-spacing:.2px}
    .tag{color:var(--muted);margin-top:4px}
    .card{background:var(--card);border-radius:16px;padding:20px;margin-top:20px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    form{display:flex;gap:10px}
    input[type="text"]{flex:1;padding:16px 14px;border-radius:12px;border:1px solid #23242e;background:#0f1016;color:var(--fg);outline:none}
    input[type="text"]::placeholder{color:#7f8596}
    button{padding:16px 18px;border:0;border-radius:12px;background:#ffffff;color:#111;font-weight:700;cursor:pointer}
    .olli{display:flex;gap:10px;align-items:center;font-size:14px;color:var(--muted);margin-top:12px}
    .chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
    .chip{font-size:14px;background:#1a1b24;border:1px solid #242633;color:#cbd1ff;padding:8px 10px;border-radius:999px;cursor:pointer}
    .historyTitle{margin-top:16px;color:#c7cad6;font-size:13px}
    .foot{margin-top:22px;color:#8086a0;font-size:13px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="logo">GameCre8</div>
    <div class="tag">Say it. Play it. Share it.</div>

    <div class="card">
      <!-- Plain HTML form -> server 302 -> browser lands on /play?slug=... -->
      <form id="promptForm" action="/api/prompt-to-play" method="get">
        <input type="hidden" name="redirect" value="1" />
        <input id="prompt" name="prompt" type="text" maxlength="120"
               placeholder="Describe your game‚Ä¶ e.g., neon galaxy blaster with enemy waves" autofocus />
        <button type="submit">Create & Play</button>
      </form>

      <!-- Olli guidance -->
      <div class="olli">üí¨ Olli: choose a style or type your own ‚Üì</div>
      <div class="chips" id="chips">
        <div class="chip" data-prompt="top-down shmup: neon galaxies, enemy waves, screen-wrap bullets">Neon Shmup</div>
        <div class="chip" data-prompt="pixel platformer in jungle ruins: spikes, moving platforms, switches">Jungle Platformer</div>
        <div class="chip" data-prompt="retro endless runner on city rooftops: coins, double-jump, dusk">Retro Rooftops</div>
        <div class="chip" data-prompt="pastel cloud collect-a-thon for kids: gentle pace, soothing music">Pastel Clouds</div>
        <div class="chip" id="surprise">Surprise me</div>
      </div>

      <div class="historyTitle">Recent prompts:</div>
      <div class="chips" id="history"></div>

      <div class="foot">
        Tips (Olli): **genre + setting + verbs + vibe** ‚Üí ‚Äúshmup in neon galaxy: dodge & shoot, synthwave‚Äù.
        Press <strong>Enter</strong> to generate.
      </div>
    </div>
  </div>

  <script>
    const input = document.getElementById('prompt');
    const form = document.getElementById('promptForm');
    const chips = Array.from(document.querySelectorAll('.chip[data-prompt]'));
    const surprise = document.getElementById('surprise');
    const historyEl = document.getElementById('history');
    const HISTORY_KEY = 'gc8_prompts_v1';

    function getHistory(){ try{ return JSON.parse(localStorage.getItem(HISTORY_KEY)||'[]'); }catch{ return []; } }
    function setHistory(arr){ localStorage.setItem(HISTORY_KEY, JSON.stringify(arr.slice(0,5))); }
    function renderHistory(){
      const arr = getHistory(); historyEl.innerHTML = '';
      arr.forEach(p => {
        const el = document.createElement('div'); el.className='chip'; el.textContent=p;
        el.addEventListener('click', ()=>{ input.value=p; input.focus(); });
        historyEl.appendChild(el);
      });
    }
    renderHistory();

    chips.forEach(c => c.addEventListener('click', () => { input.value = c.dataset.prompt; input.focus(); }));
    surprise.addEventListener('click', () => {
      const pool = chips.map(c => c.dataset.prompt);
      const pick = pool[Math.floor(Math.random() * pool.length)];
      input.value = pick; input.focus();
    });

    // Ensure empty submissions get a suggestion instead of failing
    form.addEventListener('submit', (e) => {
      if (!input.value.trim()) {
        const pool = chips.map(c => c.dataset.prompt);
        input.value = pool[Math.floor(Math.random() * pool.length)];
      }
      // Save to history
      const h = getHistory(); h.unshift(input.value.trim()); setHistory([...new Set(h)]);
      renderHistory();
    });
  </script>
</body>
</html>
